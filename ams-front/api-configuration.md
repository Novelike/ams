# API 서버 연결 설정 가이드

이 문서는 AMS 프론트엔드 애플리케이션과 백엔드 API 서버 간의 연결 설정 방법을 설명합니다.

## 개요

AMS 프론트엔드 애플리케이션은 환경에 따라 다른 백엔드 API 서버에 연결됩니다:

- **개발 환경**: `localhost:8000`
- **프로덕션 환경**: `prod_server:8000`

이 설정은 환경 변수 파일을 통해 관리되며, 빌드 시점에 적용됩니다.

## 환경 설정 파일

애플리케이션은 다음 두 개의 환경 설정 파일을 사용합니다:

1. `.env.development`: 개발 환경 설정
   ```
   VITE_API_BASE_URL=http://localhost:8000
   ```

2. `.env.production`: 프로덕션 환경 설정
   ```
   VITE_API_BASE_URL=http://prod_server:8000
   ```

## 환경별 빌드 및 실행 방법

### 개발 환경

개발 환경에서는 다음 명령어로 애플리케이션을 실행합니다:

```bash
npm run dev
```

이 명령어는 `.env.development` 파일의 설정을 사용하여 `localhost:8000`에 연결됩니다.

### 프로덕션 환경

프로덕션 환경으로 빌드하려면 다음 명령어를 실행합니다:

```bash
npm run build
```

이 명령어는 `.env.production` 파일의 설정을 사용하여 `prod_server:8000`에 연결됩니다.

## 배포 프로세스

`build-and-deploy.bat` 스크립트는 다음과 같은 단계로 애플리케이션을 배포합니다:

1. 백엔드 API 서버 연결 확인 (`prod_server:8000`에 연결 가능한지 테스트)
2. React 애플리케이션 빌드 (프로덕션 모드)
3. 빌드 파일을 Bastion 서버로 전송
4. Bastion 서버에서 배포 스크립트 실행
5. Front 서버에서 애플리케이션 재시작

## 호스트 이름 설정

프로덕션 환경에서 `prod_server` 호스트 이름을 사용하려면 다음 중 하나의 방법을 사용할 수 있습니다:

1. **호스트 파일 수정**: Windows의 경우 `C:\Windows\System32\drivers\etc\hosts` 파일에 다음 줄을 추가합니다:
   ```
   10.0.0.X    prod_server
   ```
   여기서 `10.0.0.X`는 실제 백엔드 API 서버의 IP 주소입니다.

2. **DNS 설정**: 내부 DNS 서버에 `prod_server` 호스트 이름을 백엔드 API 서버의 IP 주소로 매핑합니다.

3. **환경 변수 직접 수정**: 특정 환경에 맞게 `.env.production` 파일의 `VITE_API_BASE_URL` 값을 직접 수정할 수도 있습니다:
   ```
   VITE_API_BASE_URL=http://실제_서버_IP:8000
   ```

## 문제 해결

### API 서버 연결 실패

`build-and-deploy.bat` 실행 시 "백엔드 API 서버 연결 실패" 메시지가 표시되는 경우:

1. 백엔드 API 서버가 실행 중인지 확인합니다.
2. `prod_server` 호스트 이름이 올바르게 설정되었는지 확인합니다.
3. 방화벽 설정을 확인하여 API 서버의 8000 포트에 접근할 수 있는지 확인합니다.
4. 네트워크 연결을 확인합니다.

### 로컬 개발 시 API 연결 문제

로컬 개발 환경에서 API 연결 문제가 발생하는 경우:

1. 백엔드 API 서버가 로컬에서 실행 중인지 확인합니다.
2. 백엔드 API 서버가 8000 포트에서 실행 중인지 확인합니다.
3. CORS 설정이 올바른지 확인합니다.